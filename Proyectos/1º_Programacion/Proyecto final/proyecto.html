<script>
    //Funciones del programa
    function aleatorio1y10() {
        return Number(Math.floor(Math.random() * 10) + 1)
    }

    function aleatorio1y5() {
        return Number(Math.floor(Math.random() * 5) + 1)
    }

    //---------------------------MAIN-------------------------------------
    //Declarar los principales estados de los animales
    let numeroAnimales = 10
    const felicidadAnimal = 4
    const alimentoAnimal = 3
    const establoAnimal = 1
    let opcion
    let acciones = 0
    let dinero = 0

    //Variables para "Mercado"
    let contadorIteraciones = 0
    let productos = [
        "Bebedero de AguağŸš°",
        "Refugio para animalesğŸ›–",
        "Juguetes para animalesğŸ§¸",
        "Malla de SombrağŸ–ï¸",
        "Sistema de RiegoğŸ’§",
        "Herramientas de LimpiezağŸ§¹",
        "Luz Solar ArtificialğŸ’¡",
        "Cercado MejoradoğŸ”"
    ]
    let productosComprados = []
    let productosActuales = []
    let productosSeleccionados = 0
    let productosTotal = productos.length
    
    
    while (productosSeleccionados < 4) {
        let indiceRandom = Math.floor(Math.random() * productosTotal)
        let productoActual = productos[indiceRandom]
        let productoComprado = false
        let productoseleccionado = false

        for (let i = 0; i < productosComprados.length; i++) {
            if (productosComprados[i] === productoActual) {
                productoComprado = true
            }
        }

        for (let x = 0; x < productosActuales.length; x++) {
            if (productosActuales[x] === productoActual) {
                productoseleccionado = true
            }
        }

        if (!productoComprado && !productoseleccionado) {
            productosActuales.push(productoActual)
            productosSeleccionados++
        }
    }



    //Variables para la salud de los animales y nombre del "establo"
    let estadoEnfermo = false
    let estadoAnimal = "ğŸ˜Š"
    let establoNombre = prompt("Dime que nombre quieres para tu establo")
    //Variable, para saber que alimento va a dar
    let darAlimento

    //Convertir Felicidad a emoji
    let textoFelicidad = []
    for (let i = 0; i < felicidadAnimal; i++) {
        textoFelicidad.push("â¤ï¸")
    }
    //Convertir alimento a emoji
    let textoAlimento = []
    for (let i = 0; i < alimentoAnimal; i++) {
        textoAlimento.push("ğŸŒ¾")
    }
    //Convertir establo a emoji
    let textoEstablo = []
    for (let i = 0; i < establoAnimal; i++) {
        textoEstablo.push("ğŸ’©")
    }
    //Bucle principal: Se detiene cuando los animales son 0 y superior de 99
    while (numeroAnimales > 0 && numeroAnimales < 99) {
        if (textoEstablo.length >= 4) {
            estadoEnfermo = true
            estadoAnimal = "ğŸ¤’"
            alert("Tus animales han enfermado ğŸ¤’")
        }
        //Muestra la pantalla inicial
        alert("Felicidad: " + textoFelicidad.join(" ") + "\nAlimentos Disponibles: " + textoAlimento.join(" ") + "\nEstablo: " + textoEstablo.join(" ")
            + "\nEstado de Salud: " + estadoAnimal + "\nNÂº Animales: " + numeroAnimales + "\nDinero: " + dinero + "G")

        opcion = prompt("Felicidad: " + textoFelicidad.join(" ") + "\nAlimentos Disponibles: " + textoAlimento.join(" ") + "\nEstablo: " + textoEstablo.join(" ")
            + "\nEstado de Salud: " + estadoAnimal + "\nNÂº Animales: " + numeroAnimales + "\nDinero: " + dinero + "G" + "\nElige una acciÃ³n: " + "\n1. ğŸ¥• ALIMENTAR A LOS ANIMALES ğŸ¥• " + "\n2. ğŸ‘JUGAR CON LOS ANIMALES ğŸ‘ "
            + "\n3. ğŸ’©LIMPIAR EL ESTABLO ğŸ’© " + "\n4. ğŸ›’ COMPRAR COMIDA ğŸ›’ " + "\n5. ğŸ©ºCURAR ANIMALES ğŸ©º " + "\n6. â„¹ï¸CONSULTAR INFORMACIÃ“N â„¹ï¸ " + "\n7. ğŸššMERCADOğŸšš")

        //Entra en la opciÃ³n "Alimentar animales"
        if (opcion == "1") {
            //ComprobaciÃ³n del "establo"
            if (textoEstablo.length <= 3) {
                darAlimento = prompt("Dime que opcion de alimento quieres dar: " + "\n1. Dar Forraje ğŸŒ¾ " + "\n2. Dar Fruta ğŸ")
                if (darAlimento == "1") {
                    if (textoAlimento.length >= 1) {
                        textoAlimento.pop()
                        acciones += 1
                        contadorIteraciones += 1
                        //Suma a los animales nÂºrandom entre 1-10
                        //Resta a los animales nÂªrandom entre 1-5
                        numeroAnimales += aleatorio1y10()
                        numeroAnimales -= aleatorio1y5()
                        alert("Le has dado de comer Forraje ğŸŒ¾")
                    } else {
                        alert("No tienes comida disponibleğŸŒ¾ğŸŒ¾")
                    }
                } else if (darAlimento == "2") {
                    //Comprueba que haya comida disponible
                    if (textoAlimento.length >= 1 && estadoEnfermo == false) {
                        textoAlimento.pop()
                        acciones += 1
                        contadorIteraciones += 1
                        numeroAnimales += aleatorio1y10()
                        numeroAnimales -= aleatorio1y5()

                        //Comprueba que no supere el limite de "felicidad"
                        if (textoFelicidad.length < 4) {
                            textoFelicidad.push("â¤ï¸")
                        }

                        alert("Le has dado de comer Fruta ğŸ")

                        //Si no hay comida, manda alert
                    } else {
                        alert("No tienes comida disponible o los animales enfermos no pueden comer frutağŸ")
                    }
                }
                //alert, por si hay demasiado extiercol, caso "alimentar"
            } else {
                alert("ğŸ’©No puedes alimentar a los animales, el entorno estÃ¡ demasiado sucioğŸ’©")
            }
        } //Entra en la opciÃ³n "Jugar con los animales"
        else if (opcion == "2") {
            //ComprobaciÃ³n del "establo"
            if (textoEstablo.length <= 3 && estadoEnfermo == false) {
                //Comprueba que haya comida disponible
                if (textoAlimento.length >= 1) {
                    textoAlimento.pop()
                    acciones += 1
                    contadorIteraciones += 1
                    numeroAnimales += aleatorio1y10()
                    numeroAnimales -= aleatorio1y5()
                    //NÂº random entre 100 y 200 para sumarselo a nuestro dinero
                    let dineroSumar = Math.floor(Math.random() * 101) + 100
                    dinero += dineroSumar

                    //Comprueba que no supere el limite de "felicidad"
                    if (textoFelicidad.length < 4) {
                        textoFelicidad.push('â¤ï¸')
                        textoFelicidad.join()
                    }
                    alert("Has ganado " + dineroSumar + "G")
                    alert("Hemos jugado con los animalesğŸ„")
                    //Si no hay comida, manda alert
                } else {
                    alert("No tienes comida disponibleğŸğŸŒ¾")
                }
                //alert, por si hay demasiado extiercol, opciÃ³n "jugar"
            } else {
                alert("No puedes jugar con los animales, ya que el ambiente es inadecuado o estÃ¡n enfermosğŸ’©ğŸ¤’")
            }
        } //Entra en la opciÃ³n "Limpiar establo"
        else if (opcion == "3") {
            if (textoEstablo.length > 0) {
                while (textoEstablo.length > 0) {
                    textoEstablo.pop()
                }
                alert("Establo limpiadoğŸ§¹ğŸ’©")
                acciones += 1
                contadorIteraciones += 1
                numeroAnimales += aleatorio1y10()
                numeroAnimales -= aleatorio1y5()
            } else {
                alert("ğŸ§¹Tienes el establo limpio, no hace falta limpiarğŸ§¹")
            }
        } //Entra en la opciÃ³n "Comprar comida"
        else if (opcion == "4") {
            if (dinero >= 100) {
                //La comida quitarÃ¡ 100 al dinero
                let costeComida = 100
                dinero -= costeComida
                if (textoAlimento.length < 4) {
                    while (textoAlimento.length < 4) {
                        textoAlimento.push("ğŸŒ¾")
                    }
                    alert("Comida repuestağŸŒ¾ğŸ, te ha costado " + costeComida + "G")
                    acciones += 1
                    contadorIteraciones += 1
                    numeroAnimales += aleatorio1y10()
                    numeroAnimales -= aleatorio1y5()
                } else {
                    alert("ğŸŒ¾No puedes comprar mÃ¡s comida, estas llenoğŸŒ¾")
                }
            } else {
                alert("No tienes suficiente dineroğŸ’²")
            }

        }//Entra en la opciÃ³n "Curar Animales"
        else if (opcion == "5") {
            if (textoEstablo.length > 0) {
                alert("Necesitas tener el establo limpio para poder curarlosğŸ§¹ğŸ§¹")
            } else {
                //Comprueba si esta el animal enfermo y si lo esta lo cura
                if (estadoEnfermo == true) {
                    estadoEnfermo = false
                    estadoAnimal = "ğŸ˜Š"
                    acciones += 1
                    contadorIteraciones += 1
                    alert("Tus animales ya estÃ¡n curados ğŸ©¹ğŸ©¹")
                    numeroAnimales += aleatorio1y10()
                    numeroAnimales -= aleatorio1y5()
                } else {
                    alert("Tus animales ya estaban saludables, no necesitan curaciÃ³n ğŸ˜ŠğŸ˜Š")
                }
            }
        }//Entra en la opciÃ³n "Consultar informacion"
        else if (opcion == "6") {
            alert("Nombre del Establo: " + establoNombre + "\nNÃºmero de animales: " + numeroAnimales)
        }
        else if (opcion == "7") {
            let productoValido = false
            while (!productoValido) {
                productos = prompt("Dime que productos quieres comprar:" + "\n1. Bebedero de Agua - 200G " + "\n2. Refugio para animales - 500G"
                    + "\n3. Juguetes para animales - 150G" + "\n4. Malla de Sombra - 300G" + "\n5. Sistema de Riego - 400G")
                if (productos === "1") {
                    alert("Has comprado Bebedero de Agua")
                }
            }
        }
        //Cuando cuente 3 acciones, se suma 1 estiercol y -1 felicidad
        //A su vez, restablece el nÂº de acciones
        if (acciones == 3) {
            alert("Se suma (+ğŸ’©) y se resta (-â¤ï¸) x cada 3 Acciones")
            textoFelicidad.pop()
            acciones = 0
            //Mientras que no haya 6 extiercoles, se seguirÃ¡ sumando
            if (textoEstablo.length < 6) {
                textoEstablo.push('ğŸ’©')
            }
        }
    }
</script>
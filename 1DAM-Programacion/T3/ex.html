<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Prueba T√©cnica 3 - Juego del Gordo de Navidad</title>
</head>

<body>
    <h1>Prueba T√©cnica 3: Juego del Gordo de Navidad</h1>
    <a href="https://classroom.github.com/a/RQJeSrro">Enlace al repo</a>
    <script>

        // =============================== FUNCIONES =============================== //

        /**
         * 1. Selecciona un d√©cimo (String) aleatorio de la lista de d√©cimos.
         * @param {string[]} listaDecimos - El array de d√©cimos disponibles.
         * @returns {string} El d√©cimo secreto seleccionado.
         */
        function seleccionarDecimo(listaDecimos) {
            // Analog√≠a: Es como sacar un papelito al azar de una bolsa.
            const indiceAleatorio = Math.floor(Math.random() * listaDecimos.length);
            return listaDecimos[indiceAleatorio];
        }


        /**
         * 2. Comprueba si un d√≠gito ya se encuentra en un array de d√≠gitos.
         * @param {string} digito - El d√≠gito (String) a buscar.
         * @param {string[]} listaDigitos - El array de d√≠gitos (acertados o err√≥neos) donde buscar.
         * @returns {boolean} True si el d√≠gito est√° en la lista, False en caso contrario.
         */
        function comprobarDigitoEnLista(digito, listaDigitos) {
            // El m√©todo .includes() es perfecto para esto.
            // Si el d√≠gito es, por ejemplo, "5", buscar√° si existe el "5" en el array.
            return listaDigitos.includes(digito);
        }


        /**
         * 3. Crea una cadena que muestra el progreso del n√∫mero.
         * Los d√≠gitos acertados se muestran, los no acertados se ocultan con un '_'.
         * @param {string} decimoSecreto - El d√©cimo completo (ej: "20250").
         * @param {string[]} digitosAdivinados - Array de d√≠gitos √∫nicos acertados (ej: ["2", "5"]).
         * @returns {string} La cadena de progreso (ej: "2 _ 2 5 _").
         */
        function mostrarProgresoNumero(decimoSecreto, digitosAdivinados) {
            // Analog√≠a: Es el cartel de "Ahorcado" que solo muestra las letras acertadas.
            let progreso = "";
            for (let i = 0; i < decimoSecreto.length; i++) {
                const digito = decimoSecreto[i];
                
                // Si el d√≠gito actual S√ç est√° en la lista de adivinados...
                if (comprobarDigitoEnLista(digito, digitosAdivinados)) {
                    progreso += digito; // Lo revelamos
                } else {
                    progreso += "_"; // Lo ocultamos
                }

                // A√±adimos un espacio para que se vea mejor (opcional)
                if (i < decimoSecreto.length - 1) {
                    progreso += " ";
                }
            }
            return progreso;
        }


        /**
         * 4. Comprueba si el jugador ha ganado, es decir, si todos los d√≠gitos del d√©cimo 
         * se han adivinado.
         * @param {string} decimoSecreto - El d√©cimo completo (ej: "20250").
         * @param {string[]} digitosAdivinados - Array de d√≠gitos √∫nicos acertados (ej: ["2", "0", "5"]).
         * @returns {boolean} True si todos los d√≠gitos del d√©cimo est√°n en el array de adivinados.
         */
        function comprobarGanador(decimoSecreto, digitosAdivinados) {
            // Analog√≠a: Tienes una lista de ingredientes de una receta. 
            // ¬øEst√°n *todos* los ingredientes ya en tu despensa?
            
            // Recorremos el d√©cimo secreto d√≠gito por d√≠gito
            for (let i = 0; i < decimoSecreto.length; i++) {
                const digitoSecreto = decimoSecreto[i];
                
                // Si encontramos UN SOLO d√≠gito del secreto que *NO* est√° en la lista de adivinados,
                // significa que A√öN no ha ganado.
                if (!comprobarDigitoEnLista(digitoSecreto, digitosAdivinados)) {
                    return false; // Sale de la funci√≥n y devuelve false inmediatamente
                }
            }
            
            // Si el loop termina, significa que *todos* los d√≠gitos se encontraron.
            return true;
        }


        // =============================== MAIN =============================== //

        let listaDecimos = [
            "00001", "12345", "54321", "77777", "20240", "15024",
            "86531", "99999", "11111", "24568", "60012", "20250"
        ]

        // 1. Usamos la funci√≥n para inicializar la variable
        let decimoSecreto = seleccionarDecimo(listaDecimos); 
        
        let arrayDigitosDecimoSecreto = decimoSecreto.split("")
        let digitosAdivinados = [], digitosErroneos = []
        let maxIntentos = 6, intentosRestantes = maxIntentos
        let ganador = false

        let entrada = "", digito = "", digitoYaUsado = false

        console.log("üéÑ ¬°Bienvenido al juego del Gordo de Navidad! üéÑ")
        console.log("Se ha seleccionado un d√©cimo premiado de 5 cifras.")
        console.log("Tienes " + maxIntentos + " intentos para descubrir el n√∫mero premiado.")

        // Solo para debug:
        // console.log("(DEBUG: D√©cimo Secreto es: " + decimoSecreto + ")"); 

        while (intentosRestantes > 0 && !ganador) {

            // 3. Usamos la funci√≥n para mostrar el progreso
            console.log("\nProgreso del d√©cimo: " + mostrarProgresoNumero(decimoSecreto, digitosAdivinados)) 
            console.log("Intentos restantes: " + intentosRestantes)
            console.log("D√≠gitos err√≥neos: " + digitosErroneos.sort().join(", ")) // Uso .sort().join(", ") para que se vea mejor

            entrada = prompt("Introduce un d√≠gito del 0 al 9:")
            digito = ""
            digitoYaUsado = false

            if (entrada != null) {
                // trim() elimina espacios en blanco al principio y al final
                digito = entrada.trim()
            }

            // isNaN() devuelve true si el valor NO es un n√∫mero.
            if (digito == null || digito.length != 1 || isNaN(Number(digito))) {
                console.log("Entrada no v√°lida. Debes introducir EXACTAMENTE un d√≠gito (0-9). No pierdes intento.")
            } else {
                
                // 2. Usamos la funci√≥n dos veces:
                // Comprobamos si el d√≠gito ya est√° en la lista de acertados O en la de err√≥neos.
                digitoYaUsado = comprobarDigitoEnLista(digito, digitosAdivinados) || comprobarDigitoEnLista(digito, digitosErroneos)

                if (digitoYaUsado == true) {
                    console.log("Ese d√≠gito ya lo intentaste antes.")
                } else {

                    // 2. Aqu√≠ comprobamos si el d√≠gito est√° en el d√©cimo secreto
                    if (comprobarDigitoEnLista(digito, arrayDigitosDecimoSecreto) == true) { 
                        console.log("¬°Correcto! Ese d√≠gito aparece en el d√©cimo premiado.")
                        digitosAdivinados.push(digito)
                    } else {
                        console.log("D√≠gito incorrecto.")
                        digitosErroneos.push(digito)
                        intentosRestantes -= 1
                    }
                }
            }

            // 4. Usamos la funci√≥n para ver si el juego ha terminado en victoria
            ganador = comprobarGanador(decimoSecreto, digitosAdivinados) 
        }

        if (ganador == true) {
            console.log("\nüéâ ¬°ENHORABUENA! Has descubierto el d√©cimo premiado: " + decimoSecreto + " üéâ")
        } else {
            console.log("\n‚ùå Te has quedado sin intentos.")
            console.log("El n√∫mero premiado era: " + decimoSecreto)
        }

    </script>
</body>

</html>
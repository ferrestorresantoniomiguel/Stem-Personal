<script>
    // =============================== FUNCIONES =============================== //

    /**
     * 1. Selecciona un d√©cimo (String) aleatorio de la lista de d√©cimos.
     * @param {string[]} listaDecimos - El array de d√©cimos disponibles.
     * @returns {string} El d√©cimo secreto seleccionado.
     */
    function seleccionarDecimo(listaDecimos) {
        // Para elegir algo al azar de un array, multiplicamos un n√∫mero random [0, 1) 
        // por la longitud del array, y usamos Math.floor para obtener un √≠ndice entero.
        const indiceAleatorio = Math.floor(Math.random() * listaDecimos.length);
        return listaDecimos[indiceAleatorio];
    }


    /**
     * 2. Comprueba si un d√≠gito ya se encuentra en un array de d√≠gitos.
     * ESTA FUNCI√ìN ES CLAVE PARA LA REUTILIZACI√ìN.
     * @param {string} digito - El d√≠gito (String) a buscar.
     * @param {string[]} listaDigitos - El array de d√≠gitos donde buscar (acertados, err√≥neos o el d√©cimo secreto).
     * @returns {boolean} True si el d√≠gito est√° en la lista, False en caso contrario.
     */
    function comprobarDigitoEnLista(digito, listaDigitos) {
        // Usamos el m√©todo .includes(), el m√°s limpio para ver si un elemento existe.
        return listaDigitos.includes(digito);
    }


    /**
     * 3. Crea una cadena que muestra el progreso del n√∫mero.
     * @param {string} decimoSecreto - El d√©cimo completo (ej: "20250").
     * @param {string[]} digitosAdivinados - Array de d√≠gitos √∫nicos acertados (ej: ["2", "5"]).
     * @returns {string} La cadena de progreso (ej: "2 _ 2 5 _").
     */
    function mostrarProgresoNumero(decimoSecreto, digitosAdivinados) {
        // Analog√≠a: Imagina que el d√©cimo es un muro y solo pintamos los ladrillos (d√≠gitos) que hemos acertado.
        let progreso = "";
        
        // Recorremos el d√©cimo completo.
        for (let i = 0; i < decimoSecreto.length; i++) {
            const digito = decimoSecreto[i];
            
            // Reutilizamos la funci√≥n 2 para comprobar.
            if (comprobarDigitoEnLista(digito, digitosAdivinados)) {
                progreso += digito; // Si lo hemos adivinado, lo mostramos.
            } else {
                progreso += "_"; // Si no, lo ocultamos.
            }

            // A√±adimos un espacio para que se vea m√°s claro en la consola.
            if (i < decimoSecreto.length - 1) {
                progreso += " ";
            }
        }
        return progreso;
    }


    /**
     * 4. Comprueba si el jugador ha ganado.
     * @param {string} decimoSecreto - El d√©cimo completo.
     * @param {string[]} digitosAdivinados - Array de d√≠gitos √∫nicos acertados.
     * @returns {boolean} True si todos los d√≠gitos del d√©cimo est√°n en el array de adivinados.
     */
    function comprobarGanador(decimoSecreto, digitosAdivinados) {
        // Recorremos el d√©cimo secreto.
        for (let i = 0; i < decimoSecreto.length; i++) {
            const digitoSecreto = decimoSecreto[i];
            
            // Si encontramos UN SOLO d√≠gito del n√∫mero premiado que no hayamos adivinado a√∫n,
            // devolvemos FALSE inmediatamente.
            if (!comprobarDigitoEnLista(digitoSecreto, digitosAdivinados)) {
                return false; 
            }
        }
        
        // Si el bucle termina sin devolver false, es que se acertaron todos.
        return true; 
    }


    // =============================== MAIN =============================== //

    let listaDecimos = [
        "00001", "12345", "54321", "77777", "20240", "15024",
        "86531", "99999", "11111", "24568", "60012", "20250"
    ]

    // Llama a la funci√≥n 1: seleccionarDecimo
    let decimoSecreto = seleccionarDecimo(listaDecimos)

    // OJO: Esta l√≠nea debe ir DESPU√âS de seleccionarDecimo, si no, dar√≠a un error (decimoSecreto no estar√≠a definida).
    let arrayDigitosDecimoSecreto = decimoSecreto.split("")
    let digitosAdivinados = [], digitosErroneos = []
    let maxIntentos = 6, intentosRestantes = maxIntentos
    let ganador = false

    let entrada = "", digito = "", digitoYaUsado = false

    console.log("üéÑ ¬°Bienvenido al juego del Gordo de Navidad! üéÑ")
    console.log("Se ha seleccionado un d√©cimo premiado de 5 cifras.")
    console.log("Tienes " + maxIntentos + " intentos para descubrir el n√∫mero premiado.")

    while (intentosRestantes > 0 && !ganador) {

        // Llama a la funci√≥n 3: mostrarProgresoNumero
        console.log("\nProgreso del d√©cimo: " + mostrarProgresoNumero(decimoSecreto, digitosAdivinados))
        console.log("Intentos restantes: " + intentosRestantes)
        // Uso .join(", ") para que el array se muestre mejor.
        console.log("D√≠gitos err√≥neos: " + digitosErroneos.join(", ")) 

        entrada = prompt("Introduce un d√≠gito del 0 al 9:")
        digito = ""
        digitoYaUsado = false

        if (entrada != null) {
            // trim() elimina espacios en blanco al principio y al final
            digito = entrada.trim()
        }

        // isNaN() devuelve true si el valor NO es un n√∫mero.
        if (digito == null || digito.length != 1 || isNaN(Number(digito))) {
            console.log("Entrada no v√°lida. Debes introducir EXACTAMENTE un d√≠gito (0-9). No pierdes intento.")
        } else {
            // Llama a la funci√≥n 2 dos veces (o con el operador ||)
            // ¬øEl d√≠gito ya est√° en la lista de adivinados O en la de err√≥neos?
            digitoYaUsado = comprobarDigitoEnLista(digito, digitosAdivinados) || comprobarDigitoEnLista(digito, digitosErroneos)

            if (digitoYaUsado == true) {
                console.log("Ese d√≠gito ya lo intentaste antes.")
            } else {

                // Llama a la funci√≥n 2 de nuevo (para el d√©cimo secreto)
                if (comprobarDigitoEnLista(digito, arrayDigitosDecimoSecreto) == true) {
                    console.log("¬°Correcto! Ese d√≠gito aparece en el d√©cimo premiado.")
                    digitosAdivinados.push(digito)
                } else {
                    console.log("D√≠gito incorrecto.")
                    digitosErroneos.push(digito)
                    intentosRestantes -= 1
                }
            }
        }

        // Llama a la funci√≥n 4: comprobarGanador
        ganador = comprobarGanador(decimoSecreto, digitosAdivinados)
    }

    if (ganador == true) {
        console.log("\nüéâ ¬°ENHORABUENA! Has descubierto el d√©cimo premiado: " + decimoSecreto + " üéâ")
    } else {
        console.log("\n‚ùå Te has quedado sin intentos.")
        console.log("El n√∫mero premiado era: " + decimoSecreto)
    }

</script>